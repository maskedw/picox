
<img style="display:block;margin:auto" alt="logo"
     src="https://raw.github.com/wiki/maskedw/picox/res/picox_logo.png" />
<!-- https://www.squarespace.com/logo -->

# これは何？

省メモリの組み込み環境を想定した軽量汎用ライブラリです。

----------------------------------------------------------------------
# 特徴

マイコンプログラム開発ではドライバ操作が大きなウエイトを占めていますが、ありがた
いことに昨今ではマイコンベンダが周辺機器のデバイスドライバを提供してくれているこ
とが多いです。

しかし、標準Cが提供する機能はあまりにも貧弱であり、標準Cライブラリがフルに使用で
きることさえ期待できない小規模組込み開発は相変わらず辛いものです。

そのため、このライブラリではなくても力技でなんとかなるが、あると嬉しい小粒なルー
チンを集めています。

CPUやOSの有無に極力依存しないように実装しているので、新たなターゲットにも即座に
利用可能です。

ベンダのライブラリとこのライブラリを組み合わせて、新規CPUでも手早くアプリケー
ションを構築することを目的としています。

想定ターゲットは、RAM 数KByte ~ 数MByte、ROM 数十KByte ~ 数十MByte程度の小規模
なCPUです。

----------------------------------------------------------------------
# Arduino, mbed , Raspberry Piとの比較

昨今では、Arduino, mbed, Raspberry Pi等、お手軽にプロトタイプを作れる環境が整っ
ており、簡単なプロトタイプの作成が信じられないほどお手軽になりました。

しかし、これらのプラットフォームは、ハードウェア依存部分も含めた形で提供されてい
るため、対応していないボードやCPUで開発を行う場合、自力で互換部分を実装する必要
があります。
低レベル開発に熟練し、かつ英語がスラスラと読める人間でないと、困難な作業になるで
しょう。

picoxは特定のターゲットを持たないため、新規プラットフォームにライブラリとして、
移植する作業はこちらの方が圧倒的に簡単ですし、mbedでpicoxを使用するということも
可能です。

また、Arduinoやmbedのライブラリは、あくまでもお手軽さを重視していますが、picoxは
実業務の使用にも耐えうるよう、インターフェースに徹底的にこだわるガチ仕様です。

その分、ライブラリの粒度が細かいため、初心者の入門用ではなく、わかっている人間が
楽をするための玄人向けという位置づけです。

日本語ドキュメントのある低級なライブラリというのは、貴重だと思われるので低級プロ
グラムに興味のある組込みプログラマ初学者〜中級者の学習用途にも最適です。

----------------------------------------------------------------------
# 動作条件

+ 1バイトは8bitであること
+ バイトオーダはビッグ or リトルエンディアンであること
+ コンパイラはANSI C99に対応していること
+ CPUは16 or 32 or 64bitであること

厳密に条件を列挙するとややこしく感じますが、要するに現行のほぼ全てのCPUとコンパ
イラに当てはまると思われます。

※<br>
8bitCPUでも現行バージョンでは動作可能だと思いますが、今後の開発で明確に動作対象
外とする可能性があります。

C99はフルサポートである必要はありません。
stdint.h, stdbool.h等のtypedef定義のヘッダと、snprintf()等の一部C99ライブラリ関
数を使用しています。

----------------------------------------------------------------------
# 依存ライブラリ

+ 標準Cライブラリ(一部C99の関数を使用)

----------------------------------------------------------------------
# ビルド方法

gitのサブモジュール機能を使用しているので、`git clone`でダウンロードした場合は、
以下のコマンドでサブモジュールの初期化を行ってください。

```sh
    cd {picox-dir}
    git submodule update --init
```

基本的にはpicox, picox_external以下のソースコードをまるごとプロジェクトに登録し、
まるごとコピーし、インクルードパスを通すだけで、簡単にビルドできるはずです。
CMake用の設定ファイルも用意しているので、このファイルも参考にしてみてください。

----------------------------------------------------------------------
# 各モジュールのリファレンス

基本的にはヘッダファイルを確認し、わからなかったらソースを読め！というスタイルで
すが、`Doxygen`で生成した
[APIドキュメント](https://maskedw.github.io/picox_apidoc/index.html)
も`GitHub Pages`にて公開しています。

----------------------------------------------------------------------
# テスト環境

このライブラリは以下の環境でテストしています。

+ MinGW 32 GCC 4.8.1
+ MSYS2 MinGW 32 GCC 4.9.2
+ MSYS2 MinGW 64 GCC 4.9.2
+ Ubuntu 14.04 GCC 4.8.4

----------------------------------------------------------------------
# 外部ライブラリ

picoxと同等のライセンス(MIT, BSD, Apache License 2.0, etc)で、有用な外部ライブラ
リは積極的に取り込んでおり、一部変更を加えて、picox_externalディレクトリにまとめ
ています。 各ライブラリのライセンスや使用方法は、それぞれのライブラリの解説を参
照してください。


+ [Unity][Unity] ユニットテストフレームワーク
+ [minIni][minIni] iniファイル操作
+ [sds][sds] 動的文字列
+ [uthash][uthash] ハッシュコンテナ を中心に各種コンテナ
+ [libfixmath][libfixmath] 16 x 16固定小数点
+ [spiffs][spiffs] ウェアレベリング機能付きSPIフラッシュ用ファイルシステム
+ [FatFs][FatFs] 組込み界隈では誰もが知る、日本産 Fatファイルシステムドライバ


[Unity]:https://github.com/ThrowTheSwitch/Unity.git
[minIni]:https://github.com/compuphase/minIni.git
[sds]:https://github.com/maskedw/sds.git
[uthash]:https://github.com/troydhanson/uthash.git
[libfixmath]:https://github.com/mhfan/libfixmath.git
[spiffs]:https://github.com/pellepl/spiffs.git
[FatFs]:http://elm-chan.org/fsw/ff/00index_j.html

----------------------------------------------------------------------
# リリースノート

## v0.1 2015/07/12
+ プロトタイプ

## v0.2 2016/01/05
+ バグ修正多数
+ 細かな機能追加
+ 独自printf追加
+ 動的文字列クラス追加
+ ストリームクラス追加

## v0.3 2016/05/04
+ バグ修正多数
+ 細かな機能追加
+ xstrモジュールの廃止(同等の関数はxstring.hで提供)
+ 各外部ライブラリのサブモジュール化
+ ファイルシステム関連の超絶強化

## Roadmap
+ v0.4 マルチタスク関連モジュールの実装
+ v0.5 HAL(Hardware Abstraction Layer)の実装
+ v0.6 v1.0に向けた調整
